<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Page</title>

  <!-- Favicon & Touch Icon -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="PHS-LOGO.png">

  <!-- CSS -->
  <link rel="stylesheet" href="style.css">

  <!-- ‚úÖ ‡¶∏‡ßá‡¶∂‡¶® ‡¶ö‡ßá‡¶ï -->
  <script>
    if (sessionStorage.getItem("studentLoggedIn") !== "true") {
      window.location.replace("index.html");
    }
  </script>
</head>
  <body>
  <!-- ‚úÖ School Branding -->
  <img src="PHS-LOGO.png" alt="SCHOOL LOGO" class="logo">
  <h1>PATHPUKUR HIGH SCHOOL (HS)</h1>
  <h2 class="blink">‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶™‡ßç‡¶§‡¶ø <span class="emoji">üì¢</span></h2>

  <!-- ‚úÖ Scrolling Notice -->
  <div class="wrapper">
    <div class="marquee-container">
      <div id="marquee" class="marquee-content"></div>
    </div>
  </div>

  <!-- ‚úÖ External Notice File -->
  <script src="student_notice.js"></script>
  <script>
  const marquee = document.getElementById("marquee");

  if (Array.isArray(studentNotices)) {
    studentNotices.forEach(notice => {
      const date = notice.date || "";  // ‡¶Ø‡¶¶‡¶ø ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ
      const text = notice.text || "";  // ‡¶Ø‡¶¶‡¶ø ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ

      // ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ï‡ßá‡¶¨‡¶æ‡¶∞‡ßá‡¶á ‡¶ñ‡¶æ‡¶≤‡¶ø ‡¶π‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶∏‡ßç‡¶ï‡¶ø‡¶™ ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶®
      if (text.trim() !== "") {
        const span = document.createElement("span");
        span.textContent = `${date} - ${text}`;
        span.style.color = notice.color || "black";
        span.style.fontWeight = "bold";
        span.style.marginRight = "30px";
        marquee.appendChild(span);
      }
    });
  } else {
    marquee.textContent = "‡¶ï‡ßã‡¶®‡ßã ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§";
  }

  // üîÅ Marquee pause on hover/touch
  marquee.addEventListener("mouseover", () => marquee.classList.add("paused"));
  marquee.addEventListener("mouseout", () => marquee.classList.remove("paused"));
  marquee.addEventListener("touchstart", () => marquee.classList.add("paused"));
  marquee.addEventListener("touchend", () => marquee.classList.remove("paused"));
</script>
  
  <!-- ‚úÖ ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡ßã‡¶∞‡ßç‡¶° -->
  <div id="notice-board"></div>
  <div class="pagination">
    <button onclick="prevPage()" id="prevBtn">‚è™ Back</button>
    <span id="pageNumber">Page 1</span>
    <button onclick="nextPage()" id="nextBtn">‚è© Next</button>
  </div>
 <!-- ‚úÖ Popup Modal -->
<div id="popupModal" style="display: none;" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header"><strong id="popupTitle">‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º</strong></div>
    <div class="modal-date"><strong>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</strong> <span id="popupDate">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</span></div>
    <div class="modal-body" id="popupBody">‡¶Æ‡ßÇ‡¶≤ ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶™‡ßç‡¶§‡¶ø</div>
    <div id="popupLinkArea" style="margin-top: 10px;"></div>
    <button id="closeModalBtn" onclick="closeModal()">‚è™ Back</button>
  </div>
</div>

  <!-- ‚úÖ External Notice Bord -->
  <script src="student_notice.js"></script>
  <script>
    const noticesPerPage = 10;
    let currentPage = 1;

    function renderNoticeTable() {
      const container = document.getElementById('notice-board');
      container.innerHTML = "";

      const start = (currentPage - 1) * noticesPerPage;
      const end = start + noticesPerPage;
      const paginatedNotices = studentTableNotices.slice(start, end);

      const table = document.createElement('table');
      table.id = 'notice-table';

      const thead = document.createElement('thead');
      thead.innerHTML = `
        <tr>
          <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
          <th>‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡¶¨‡¶∏‡ßç‡¶§‡ßÅ</th>
          <th>‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶™‡ßç‡¶§‡¶ø</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement('tbody');
      paginatedNotices.forEach(notice => {
        const tr = document.createElement('tr');

        tr.innerHTML = `
          <td>${notice.date}</td>
          <td style="color: ${notice.color || '#000'};">${notice.text}</td>
<td>
  <button onclick="showPopup('${notice.text}', '${notice.date}', '${notice.link || ''}')" onmouseover="this.style.opacity=0.8" onmouseout="this.style.opacity=1">
    View
  </button>
</td>   
        `;
        tbody.appendChild(tr);
      });

      table.appendChild(tbody);
      container.appendChild(table);

      const totalPages = Math.ceil(studentTableNotices.length / noticesPerPage);
      document.getElementById('pageNumber').textContent = `Page ${currentPage} of ${totalPages}`;
      document.getElementById('prevBtn').disabled = currentPage === 1;
      document.getElementById('nextBtn').disabled = currentPage === totalPages;
    }

    function nextPage() {
      if (currentPage < Math.ceil(studentTableNotices.length / noticesPerPage)) {
        currentPage++;
        renderNoticeTable();
      }
    }

    function prevPage() {
      if (currentPage > 1) {
        currentPage--;
        renderNoticeTable();
      }
    }

    // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
    renderNoticeTable();
  </script>

<script>
  window.onload = () => {
    loadStudentExamLinks();   // ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® ‡¶≤‡ßã‡¶°
    renderNoticeTable();      // ‡¶ü‡ßá‡¶¨‡¶ø‡¶≤ ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶≤‡ßã‡¶°
  };
</script>
  
  <script> // Student Table Notice popup handle
  function showPopup(titleText, date, link, subjText) {
  document.getElementById('popupTitle').textContent = titleText;
  document.getElementById('popupDate').textContent = "‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: " + date;

  const body = document.getElementById('popupBody');

  // ‡¶Ø‡¶¶‡¶ø subj ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ ‡¶®‡¶æ ‡¶π‡¶Ø‡¶º, ‡¶§‡¶¨‡ßá ‡¶¨‡¶°‡¶ø‡¶§‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì
  if (subjText && subjText.trim() !== "") {
    body.innerHTML = `<p style="text-align:justify;">${subjText}</p>`;
  } else {
    body.innerHTML = ""; // ‡¶™‡ßÅ‡¶∞‡ßã‡¶™‡ßÅ‡¶∞‡¶ø ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ ‡¶∞‡¶æ‡¶ñ‡ßã
  }

  const linkArea = document.getElementById('popupLinkArea');
  linkArea.innerHTML = "";

  if (link && link.trim() !== "") {
    const a = document.createElement("a");
    a.href = link;
    a.target = "_blank";
    a.textContent = "üîó ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®";
    a.style.display = "inline-block";
    a.style.marginTop = "10px";
    a.style.background = "#007bff";
    a.style.color = "white";
    a.style.padding = "6px 12px";
    a.style.borderRadius = "5px";
    a.style.textDecoration = "none";
    linkArea.appendChild(a);
  }
  document.getElementById('popupModal').style.display = 'flex';
}


function closeModal() {
  document.getElementById('popupModal').style.display = 'none';
}

</script>

  <h2 style="text-align:center;">üìÑ ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ üìÑ</h2>
  <div id="exam-buttons" style="text-align:center;"></div>

  <script>
    let studentData = {};

    // ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶≤‡ßã‡¶°
    function loadStudentExamLinks() {
      fetch('config_student.json')
      // fetch('https://script.google.com/macros/s/AKfycbwwfRPjHO_S_nVIJPnC90G0jQkbeWRFMU6R2XmQWjpdLYyu7p56Xe7KKgHDdlioJiienQ/exec?sheet=StudentLink') // ‚Üê <-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ Apps Script URL ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶∏‡¶æ‡¶®
        .then(response => response.json())
        .then(data => {
          studentData = data;
          renderStudentButtons();
        })
        .catch(error => {
          console.error('‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ‡¶≤‡ßã‡¶°‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ:', error);
        });
    }

    // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ì ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
    function renderStudentButtons() {
      const container = document.getElementById('exam-buttons');
      container.innerHTML = '';

      // ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø
      const classes = [...new Set(Object.keys(studentData).map(k => k.split('_')[0]))];

      classes.forEach(cls => {
        const title = document.createElement('div');
        title.className = 'class-title';
        title.textContent = 'CLASS ' + cls.replace('X_TEST', 'X');
        container.appendChild(title);

        const exams = ['1ST', '2ND', '3RD', 'TEST'];
        exams.forEach(exam => {
          const key = `${cls}_${exam}`;
          if (studentData[key]) {
            const link = studentData[key].url;
            const a = document.createElement('a');
            a.className = 'exam-link';
            a.textContent = exam === 'TEST' ? 'TEST EXAM' : exam;
            a.href = '#';
            a.onclick = (e) => {
  e.preventDefault();
  // ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®
  const oldMsg = a.nextElementSibling;
  if (oldMsg && oldMsg.classList.contains('avail-msg')) {
    oldMsg.remove();
  }

  if (link && link.trim() !== '') {
    window.open(link, '_blank');
  } else {
    const msg = document.createElement('div');
    msg.className = 'avail-msg';
    msg.textContent = 'üîî ‡¶∂‡ßÄ‡¶ò‡ßç‡¶∞‡¶á ‡¶â‡¶™‡¶≤‡¶¨‡ßç‡¶ß ‡¶π‡¶¨‡ßá üîî';

    a.parentNode.insertBefore(msg, a.nextSibling);

    // 3 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ‡¶ü‡¶ø ‡¶Ö‡¶ü‡ßã ‡¶ó‡¶æ‡ßü‡ßá‡¶¨ ‡¶π‡¶¨‡ßá
    setTimeout(() => {
      msg.remove();
    }, 3000);
  }
};
            container.appendChild(a);
          }
        });
      });
    }
  </script>
  
  <!-- Footer -->
  <footer>
    <hr>
    ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶®‡¶æ‡¶Ø‡¶º, ‡¶™‡¶æ‡¶§‡¶™‡ßÅ‡¶ï‡ßÅ‡¶∞ ‡¶π‡¶æ‡¶á ‡¶∏‡ßç‡¶ï‡ßÅ‡¶≤ (‡¶â‡¶É ‡¶Æ‡¶æ‡¶É)
  </footer>

  <!-- Main JS -->
  <script src="script.js"></script>
</body>
</html>
